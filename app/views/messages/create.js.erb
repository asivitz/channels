var added;

var msg = $("<%= escape_javascript(render :partial => "channels/message", :object => @message) %>");
var latestContainer = null;

if (topPoster() == '<%= @message.poster %>:')
{
    latestContainer = getLatestContainer();
    added = msg;
}
else
{
    latestContainer = makeContainer('<%= @message.poster %>', '<%= @message.pretty_updated_at %>');
    latestContainer.prependTo('#message_list');
    added = latestContainer;
}

var ul = latestContainer.find('.message_content');
msg.appendTo(ul);

added.hide().fadeIn();

$('#msginput').val("");

spinOff();
